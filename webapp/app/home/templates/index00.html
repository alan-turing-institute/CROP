{% extends "base_site.html" %}

{% block title %} INDEX {% endblock title %}

{% block stylesheets %}
{{ super() }}
<link href="{{ url_for('static', filename='vendors/datatables.net-bs/css/dataTables.bootstrap.min.css') }}"
    rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/datatables.net-buttons-bs/css/buttons.bootstrap.min.css') }}"
    rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/datatables.net-fixedheader-bs/css/fixedHeader.bootstrap.min.css') }}"
    rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/datatables.net-responsive-bs/css/responsive.bootstrap.min.css') }}"
    rel="stylesheet">
<link href="{{ url_for('static', filename='vendors/datatables.net-scroller-bs/css/scroller.bootstrap.min.css') }}"
    rel="stylesheet">
{% endblock stylesheets %}


{% block content %}
<div class="right_col" role="main">
    <!-- top tiles -->
    <div class="row tile_count">
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Total tonnes Growth</span>
            <div class="count">15t</div>
            <span class="count_bottom"><i class="green">4% </i> From last Week</span>
        </div>
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-clock-o"></i> Energy use/m2</span>
            <div class="count">-</div>
            <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>- </i> From last Week1</span>
        </div>
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Total Data Points</span>
            <div class="count green">200,500</div>
        </div>
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Total no Sensors</span>
            <div class="count">8</div>
        </div>
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Total Midnight Collectors</span>
            <div class="count">4</div>
        </div>
        <div class="col-md-2 col-sm-4 col-xs-6 tile_stats_count">
            <span class="count_top"><i class="fa fa-user"></i> Total Missing Entries</span>
            <div class="count">7,325</div>
            <span class="count_bottom"><i class="green"><i class="fa fa-sort-asc"></i>4% </i> From last Week</span>
        </div>
    </div>
    <!-- /top tiles -->

    <!--3D Unity container-->
    <div class="row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="x_panel">


                <!-- <div class="x_content">
                <canvas id="c" style="width: 100%; height: 100%;">
                    Text to alert visitors that the Canvas
                    is not supported by your browser.
                </canvas>

            </div> -->

                <div class="webgl-content">
                    <div id="unityContainer" style="height: 45vh"></div>
                    <div class="footer">
                        <div class="webgl-logo"></div>
                        <div class="fullscreen" onclick="unityInstance.SetFullscreen(1)"></div>
                        <div class="title">CROP_Unity_3D</div>
                    </div>
                </div>

            </div>
        </div>

    </div>
    <!--/3D Unity container-->

    <br />

    <div class="row">
        <!--warnings feed-->
        <div class="col-md-4 col-sm-4 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Propagation/R&D <small>Alerts</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="dashboard-widget-content">
                        <ul class="list-unstyled timeline widget">
                            <li>
                                <div class="block">
                                    <div class="block_content">
                                        <h2 class="title">
                                            <a>ALL OK IN PROPAGATION AND R&D</a>
                                        </h2>
                                        <div class="byline">
                                            <span>1 hour ago</span> by <a>Crop</a>
                                        </div>
                                        <p class="excerpt">.
                                            <a>Read&nbsp;More</a>
                                        </p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>



        <!--warnings feed-->
        <div class="col-md-4 col-sm-4 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Energy/Weather <small>Alerts</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="dashboard-widget-content">
                        <ul class="list-unstyled timeline widget">
                            <li>
                                <div class="block">
                                    <div class="block_content">
                                        <h2 class="title">
                                            <a>High Temperature in London</a>
                                        </h2>
                                        <div class="byline">
                                            <span>13 hours ago</span> by <a>Advanticsys 1</a>
                                        </div>
                                        <p class="excerpt">Predicted hot weather today at 12:30
                                            Temperature will reach 27o
                                            <a>Read&nbsp;More</a>
                                        </p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <br />

    <br />
    <div class="row">
        <!-- main farm -->
        <!--round charts-->
        <div class="col-md-8 col-sm-8 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Main Farm  <small>Performance</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="dashboard-widget-content">
                        <div class="block">
                            <div class="block_content">
                                <!-- <style>
                                    table, th, td {
                                      border:1px solid black;
                                      overflow:visible;
                                    }
                                </style> -->
                                <table style="table-layout: fixed;width:100%; overflow:visible">
                                    <tr>
                                        <th><span id="zone1_name"></span></th>
                                        <th><span id="zone2_name"></span></th>
                                        <th><span id="zone0_name"></span></th>
                                    </tr>
                                </table>

                                <table style="table-layout: fixed;width:100%; overflow:visible">
                                    <tr >
                                        <p>Temperature Counts</p>

                                        <th width=25% >
                                                <canvas id="roundchart1" ></canvas>
                                                <p>weekly</p>
                                            </th>
                                        <th width=15% valign="top">
                                                <canvas id="roundchart11" ></canvas>
                                                <p>daily</p>
                                            </th>
                                        <th width=25% >
                                            <span id="zone2_name"></span>
                                            <canvas id="roundchart2" ></canvas>
                                            <p>weekly</p>
                                        </th>
                                        <th width=15% valign="top" >
                                            <canvas id="roundchart12"></canvas>
                                            <p>daily</p>
                                        </th>
                                        <th width=25% > 
                                            <span id="zone0_name"></span>
                                            <canvas id="roundchart0" ></canvas>
                                            <p>weekly</p> 
                                        </th>
                                        <th width=15% valign="top">
                                            <canvas id="roundchart10" ></canvas>
                                            <p>daily</p>
                                        </th>
                                    </tr>
                                </table>

                                <table style="table-layout: fixed;width:100%; overflow:visible">
                                    <tr >
                                        <p>Humidity Counts</p>
                                        <th width=25% >
                                            <canvas id="roundchart6" ></canvas>
                                            <p>weekly</p>
                                        </th>
                                        <th width=15% valign="top">
                                            <canvas id="roundchart16" ></canvas>
                                            <p>daily</p>
                                        </th>
                                        <th width=25% >
                                            <canvas id="roundchart7" ></canvas>
                                            <p>weekly</p>
                                        </th>
                                        <th width=15% valign="top" >
                                            <canvas id="roundchart17"></canvas>
                                            <p>daily</p>
                                        </th>
                                        <th width=25% > 
                                            <canvas id="roundchart5" ></canvas>
                                            <p>weekly</p>
                                        </th>
                                        <th width=15% valign="top">
                                            <canvas id="roundchart15" ></canvas>
                                            <p>daily</p>
                                        </th>
                                    </tr>

                                </table>
                                      
                            </div>
                        </div>
                        
                    </div>
                </div>
                <div class="x_content">
                    <h4>Vertical Stratification</h4>
                    <!--<span id="zensie_sensor_names"></span>-->
                    <!-- <p> Vertical Stratification </p> -->
                    <canvas id="stackedbarchart20"></canvas>
                </div>
            </div>
        </div>

        <!--warnings feed-->
        <div class="col-md-4 col-sm-4 col-xs-14">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Farm <small>Alerts</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="dashboard-widget-content">
                        <ul class="list-unstyled timeline widget">
                            <li>
                                <div class="block">
                                    <div class="block_content">
                                        <h2 class="title">
                                            <a>High Temperature in Farm1 entrance</a>
                                        </h2>
                                        <div class="byline">
                                            <span>13 hours ago</span> by <a>Advanticsys 1</a>
                                        </div>
                                        <p class="excerpt">Sensor Advantsys recorded a temperature of 25o in the
                                            entrace. Suggested action :
                                            1. turn on fans
                                        </p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="block">
                                    <div class="block_content">
                                        <h2 class="title">
                                            <a>High Humidity Back of Farm</a>
                                        </h2>
                                        <div class="byline">
                                            <span>13 hours ago</span> by <a>Zenzie 3</a>
                                        </div>
                                        <p class="excerpt">Sensor Zenzie recorded humidity 82 in the
                                            back of the Farm
                                        </p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br />

    <br />
    <div class="row">
        <!-- Propagation -->
        <!--round charts-->
        <div class="col-md-6 col-sm-6 col-xs-12">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Propagation  <small>Performance</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="dashboard-widget-content">
                        <div class="block">
                            <div class="block_content">
                                <table style="table-layout: fixed;width:100%; overflow:visible">
                                    <tr>
                                        <td>Temperature</td>
                                        <td>Humidity</td>
                                    </tr>
                                </table>

                                <table style="table-layout: fixed;width:100%; overflow:visible">
                                    <tr >
                                        <b><span id="zone3_name"></span></b>
                                        <td width=25% >
                                                <canvas id="roundchart3" ></canvas>
                                                <p>weekly</p>
                                            </td>
                                        <td width=15% valign="top">
                                                <canvas id="roundchart13" ></canvas>
                                                <p>daily</p>
                                            </td>
                                        <td width=25% >
                                            <canvas id="roundchart8" ></canvas>
                                            <p>weekly</p>
                                        </td>
                                        <td width=15% valign="top">
                                            <canvas id="roundchart18" ></canvas>
                                            <p>daily</p>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--warnings feed-->
        <div class="col-md-6 col-sm-6 col-xs-14">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Farm <small>Alerts</small></h2>
                    <ul class="nav navbar-right panel_toolbox">
                        <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                        </li>
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                aria-expanded="false"><i class="fa fa-wrench"></i></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#">Settings 1</a>
                                </li>
                                <li><a href="#">Settings 2</a>
                                </li>
                            </ul>
                        </li>
                        <li><a class="close-link"><i class="fa fa-close"></i></a>
                        </li>
                    </ul>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="dashboard-widget-content">
                        <ul class="list-unstyled timeline widget">
                            <li>
                                <div class="block">
                                    <div class="block_content">
                                        <h2 class="title">
                                            <a>High Temperature in Farm1 entrance</a>
                                        </h2>
                                        <div class="byline">
                                            <span>13 hours ago</span> by <a>Advanticsys 1</a>
                                        </div>
                                        <p class="excerpt">Sensor Advantsys recorded a temperature of 25o in the
                                            entrace. Suggested action :
                                            1. turn on fans
                                        </p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="block">
                                    <div class="block_content">
                                        <h2 class="title">
                                            <a>High Humidity Back of Farm</a>
                                        </h2>
                                        <div class="byline">
                                            <span>13 hours ago</span> by <a>Zenzie 3</a>
                                        </div>
                                        <p class="excerpt">Sensor Zenzie recorded humidity 82 in the
                                            back of the Farm
                                        </p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br />

    <br />


</div>

{% endblock content %}

{% block javascripts %}
{{ super()}}
<!-- Chart.js -->
<script src="{{ url_for('static', filename='vendors/Chart.js/dist/Chart.min.js') }}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.bundle.js"></script>
<!-- gauge.js -->
<script src="{{ url_for('static', filename='vendors/gauge.js/dist/gauge.min.js') }}"></script>
<!-- Skycons -->
<script src="{{ url_for('static', filename='vendors/skycons/skycons.js') }}"></script>
<!-- Flot -->
<script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.pie.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.time.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.stack.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/Flot/jquery.flot.resize.js') }}"></script>
<!-- Flot plugins -->
<script src="{{ url_for('static', filename='vendors/flot.orderbars/js/jquery.flot.orderBars.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/flot-spline/js/jquery.flot.spline.min.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/flot.curvedlines/curvedLines.js') }}"></script>
<!-- DateJS -->
<script src="{{ url_for('static', filename='vendors/DateJS/build/date.js') }}"></script>
<!-- JQVMap -->
<script src="{{ url_for('static', filename='vendors/jqvmap/dist/jquery.vmap.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/jqvmap/dist/maps/jquery.vmap.world.js') }}"></script>
<script src="{{ url_for('static', filename='vendors/jqvmap/examples/js/jquery.vmap.sampledata.js') }}"></script>

<!-- 3D models -->
<script src="{{ url_for('static', filename='structures/CROP_unity_js/TemplateData/UnityProgress.js') }}"></script>
<script src="{{ url_for('static', filename='structures/CROP_unity_js/Build/UnityLoader.js') }}"></script>
<script>
    var unityInstance = UnityLoader.instantiate("unityContainer", "{{ url_for('static', filename='structures/CROP_unity_js/Build/CROP_unity_js.json') }}", { onProgress: UnityProgress });
</script>
<link href="{{ url_for('static', filename='structures/CROP_unity_js/Build/CROP_unity_js.json') }}" rel="stylesheet">


<script>


    //Imports from backend
    var temperature_json = JSON.parse('{{temperature_data | safe}}');
    var humidity_json = JSON.parse('{{humidity_data | safe}}');
    var temperature_json_daily = JSON.parse('{{temperature_data_daily | safe}}');
    var humidity_json_daily = JSON.parse('{{humidity_data_daily | safe}}');
    var vertical_stratification_json = JSON.parse('{{vertical_stratification | safe}}');
    

    //var json_obj = JSON.parse('{{json_values | safe}}');

    //console.warn(temperature_data[0]["Values"][0]["bin"]);
    function check_data(data) {
        if (Object.keys(data).length === 0 && data.constructor === Object) {
            console.warn("dataset is empty")
        }
        else console.log("its good data", data)
    }

    function time_series_charts(json_data, canvasname) {
        values_top = []
        values_bot = []
        dates = []
        for (j = 0; j < json_data[0]["Values"].length; j++) {
            values_top.push(parseFloat(json_data[0]["Values"][j]["temperature"]))
            values_bot.push(parseFloat(json_data[1]["Values"][j]["temperature"]))
            dates.push(json_data[0]["Values"][j]["timestamp"])
        }

        const data = {
            labels: dates,
            datasets: [
                {
                    label: 'Top',
                    data: values_top,
                    borderColor: "#ff0000",
                    pointRadius:1,
                    borderWidth: 1
                },
                {
                    label: 'Bottom',
                    data: values_bot,
                    borderColor: "#3399ff",
                    pointRadius:1,
                    borderWidth:1
                }
            ]
        };
        const config = {
            type: 'line',
            data: data,
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Vertical Stratification'
                    }
                }
            },
        };
        var ctx = document.getElementById(canvasname);
        var myChart = new Chart(ctx, config);
    }



    function roundcharts (json_data, zoneid, canvasname, colouramp) 
    {
        console.log (json_data[zoneid])

        bin_ = []
        cnt_ = []
        for (j = 0; j < json_data[zoneid]["Values"].length; j++) {
            bin_.push(json_data[zoneid]["Values"][j]["bin"])
            cnt_.push(parseFloat(json_data[zoneid]["Values"][j]["cnt"]))
        }

        const data_ = [];
        data_.push({
            label:  [json_data[zoneid]["zone"]],
            data: cnt_, 
            backgroundColor: colouramp
        })
        //title: [json_data[zoneid]["zone"]],

        const data = {
            labels: bin_,
            datasets: data_
        };

        const config = {
            type: 'doughnut',
            data: data,
            options:
            {
                legend: {
                    display: false
                },
                aspectRatio: 1.5,
            }
        };
        //roundchart0
        var ctx = document.getElementById(canvasname);
        var myChart = new Chart(ctx, config);
    }

    function horizontal_charts(json_data, zoneid, canvasname, colouramp) {
        
        //iterates through zones (5)
        bin_ = []
        cnt_ = []
        for (j = 0; j < json_data[zoneid]["Values"].length; j++) {
            bin_.push(json_data[zoneid]["Values"][j]["bin"])
            cnt_.push(parseFloat(json_data[zoneid]["Values"][j]["cnt"]))
        }

        const datasets_ = [];
        for (i = 0; i < bin_.length; i++) {
            datasets_.push({
                label: bin_[i],
                data: [cnt_[i]],
                backgroundColor: colouramp[i],
            })
        }

        const data = {
            labels: [json_data[zoneid]["zone"]],
            datasets: datasets_
        };

        const config = {
            type: 'horizontalBar',
            data: data,
            options:
            {

                legend: {
                    display: false
                },
                scales: {
                    xAxes: [{
                        stacked: true,
                        display: false, //this will remove all the x-axis grid lines
                    }],
                    yAxes: [{
                        stacked: true,
                        //display: true,
                        position: 'right',
                    }]
                },
                aspectRatio: 6.5,
                tooltips: {
                    
                    callbacks: {
                        position: 'average',
                        title: function (tooltipItems, data) {
                            return '';
                        },
                    }
                }
            }
        };

        //var ctx = document.getElementById('stackedbarchart'.concat(0));
        var ctx = document.getElementById(canvasname);
        var myChart = new Chart(ctx, config);

    }

    function create_charts(temperature_data, temperature_data_daily, humidity_data, humidity_data_daily, vertical_stratification) {
        var colouramp_redblue = ["rgba(63,103,126,1)", "rgba(27,196,121,1)", "rgba(137,214,11,1)", "rgba(207,19,10,1)"]; //blue to red
        var colouramp_blue = ["rgba(27,55,74,1)", "rgba(0,96,196,1)", "rgba(0,129,196,1)", "rgba(141,245,252,1)"];

        //main farm
        //round charts ("roundchart0")
        var zone0_name = temperature_data[0]["zone"]
        document.getElementById("zone0_name").innerHTML = zone0_name;
        roundcharts (temperature_data, 0, "roundchart0", colouramp_redblue) 
        
        var zone1_name = temperature_data[1]["zone"]
        document.getElementById("zone1_name").innerHTML = zone1_name;
        roundcharts (temperature_data, 1, "roundchart1", colouramp_redblue) 
        
        var zone2_name = temperature_data[2]["zone"]
        document.getElementById("zone2_name").innerHTML = zone2_name;
        roundcharts (temperature_data, 2, "roundchart2", colouramp_redblue)
        //roundcharts (temperature_data, 3, "roundchart3", colouramp_redblue)


        roundcharts (temperature_data_daily, 0, "roundchart10",colouramp_redblue)
        roundcharts (temperature_data_daily, 1, "roundchart11",colouramp_redblue)
        roundcharts (temperature_data_daily, 2, "roundchart12",colouramp_redblue)

        roundcharts(humidity_data, 0, "roundchart5",colouramp_blue);
        roundcharts(humidity_data, 1, "roundchart6",colouramp_blue);
        roundcharts(humidity_data, 2, "roundchart7",colouramp_blue);

        roundcharts(humidity_data_daily, 0, "roundchart15",colouramp_blue)
        roundcharts(humidity_data_daily, 1, "roundchart16",colouramp_blue)
        roundcharts(humidity_data_daily, 2, "roundchart17",colouramp_blue)


        //vertical stratification
        time_series_charts(vertical_stratification, "stackedbarchart20");


        //Propagation
        var zone3_name = temperature_data[3]["zone"]
        document.getElementById("zone3_name").innerHTML = zone0_name;
        roundcharts (temperature_data, 3, "roundchart3", colouramp_redblue) 
        roundcharts (temperature_data_daily, 3, "roundchart13",colouramp_redblue)

        roundcharts(humidity_data, 3, "roundchart8",colouramp_blue);
        roundcharts(humidity_data_daily, 3, "roundchart18",colouramp_blue)


    }

    check_data(temperature_json);
    check_data(temperature_json_daily);
    check_data(humidity_json);
    check_data(vertical_stratification_json);

    create_charts(temperature_json, temperature_json_daily, humidity_json, humidity_json_daily, vertical_stratification_json);





    // iterate locations
    // for (i = 0; i < zensie_temp_data.length; i++) {

    //     sensor_temp_data = zensie_temp_data[i];
    //     temp_cnts = [];

    //     // // iterate temperature bins
    //     for (j = 0; j < sensor_temp_data.length; j++) {

    //         //console.warn(sensor_temp_data[j])

    //         temp_range_data = sensor_temp_data[j][1];

    //         temp_cnts.push(temp_range_data[0].temp_cnt);
    //     }
    //     cnts.push(temp_cnts)
    // }

    // const transpose = (cnts) => {
    //     let [row] = cnts
    //     return row.map((value, column) => cnts.map(row => row[column]))
    // }

    // const dataset_matrix = transpose(cnts);

    // TEMP_BINS = [0.0, 17.0, 21.0, 24.0, 30.0]

    // const datasets_ = [];
    // for (i = 0; i < dataset_matrix.length; i++) {
    //     datasets_.push({
    //         label: TEMP_BINS[i],
    //         data: dataset_matrix[i],
    //         backgroundColor: colouramp[i],
    //     })
    // }


    // const data = {
    //     labels: sensor_locations,
    //     datasets: datasets_
    // };

    // console.warn(data)
    // const config = {
    //     type: 'horizontalBar',
    //     data: data,
    //     //options: barOptions_stacked,
    //     options:
    //     {
    //         scales: {
    //             xAxes: [{ stacked: true }],
    //             yAxes: [{ stacked: true }]
    //         }
    //     }
    // };
    // var myChart = new Chart(ctx, config);

</script>


<!--

<script>

    //var zensie_sensor_names = '{{ zensie_sensors }}';
    // <block:setup:1>
    var ctx = document.getElementById('stackedbarchart');

    const labels = ["2014", "2013", "2012", "2011", "2010"];
    const data = {
        labels: labels,
        datasets: [
            {
                label: 'Low',
                data: [227, 589, 537, 543, 574],
                backgroundColor: "rgba(63,103,126,1)",
                //backgroundColor: '#D6E9C6' // green
            },
            {
                label: 'Moderate',
                data: [1238, 553, 746, 884, 903],
                backgroundColor: "rgba(63,203,226,1)",
                //backgroundColor: '#FAEBCC' // yellow
            },
            {
                label: 'High',
                data: [238, 553, 746, 884, 903],
                backgroundColor: "rgba(180,60,60,1)",
                //backgroundColor: '#EBCCD1' // red
            }
        ]
    };
    // </block:setup>

    // <block:config:0>
    const config = {
        type: 'horizontalBar',
        data: data,
        //options: barOptions_stacked,
        options:
        {
            scales: {
                xAxes: [{ stacked: true }],
                yAxes: [{ stacked: true }]
            }
        }
    };

    var myChart = new Chart(ctx, config);
</script> -->


{% endblock javascripts %}